Red & White Wine Quality by Di Wang
========================================================
  
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(dplyr)
library(GGally)
library(scales)
library(memisc)
library(reshape)
library(gridExtra)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wineQualityReds <- read.csv('wineQualityReds.csv')
wineQualityWhites <- read.csv('wineQualityWhites.csv')
wineQualityReds['color']='Red'
wineQualityWhites['color']='White'
df <- union(wineQualityReds,wineQualityWhites)
```

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}
dim(df)
names(df)
str(df)
summary(df)
```


The quality of wine has a slightly skewed normal distribution. Most wine were rated as 5 or 6. The lowest rating is 3 and the highest rating is 9.
We would like to plot the distribution of each individual factors and try to find the potential relationships.

```{r echo=FALSE,message=FALSE,warning=FALSE, multiple}
grid.arrange(qplot(df$fixed.acidity),
             qplot(df$volatile.acidity),
             qplot(df$citric.acid),
             qplot(df$residual.sugar),
             qplot(df$chlorides),
             qplot(df$free.sulfur.dioxide),
             qplot(df$total.sulfur.dioxide),
             qplot(df$density),
             qplot(df$pH),
             qplot(df$sulphates),
             qplot(df$alcohol,binwidth = 0.1),
             qplot(df$quality),
             ncol = 4)
```

At the first glance, the following factors have normal distribution:
1. Fixed Acidity
2. Volatile.acidity
3. Desity
4. PH

And, the following factors have a slightly skewed distribution,which is more like the quality distribution:
1. citric.acid
2. residual.sugar
3. chlorides
4. free.sulfur.dioxide
5. total.sulfur.dioxide
6. sulphates
7. alcohol

Due to the nature of the description, the (11) factors can be classified as following:
1. Acids
2. Sugar
3. Alcohol
4. Chlorides
5. Sulphates

We will mainly examine these (5) factors and their relationship to quality.

# Univariate Analysis

### What is the structure of your dataset?

There are 6497 observations of 14 variables (X,fixed.acidity,volatile.acidity,citric.acid,residual.sugar,chlorides,free.sulfur.dioxide,total.sulfur.dioxide,density,pH,sulphates,alcohol,quality,color).
Quality is an ordered, categorical, discrete variable. It was on a 0-10 scale, rated by at least 3 wine experts. The values ranged only from 3 to 9, with a mean of 5.818 and median of 6.
X is the numbering system for the wine samples.
Color was a created categorical factor.
All other variables are all quantitative factors about the chemical content in wine.

### What is/are the main feature(s) of interest in your dataset?

The main feature of interest is the factors affecting the quality of red/white wine. I suspected that the alcohol, residual.sugar and PH will affect the quality of red/white wine. 
The other point of interest is the difference between red/white wine.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?

From the description of the variables, it seems that the fixed.acidity & volatile.acidity, free.sulfur.dioxide & total.sulfur.dioxide, alcohol & density can be corralated variables.

### Did you create any new variables from existing variables in the dataset?

Yes, 'color' was the created new variables.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?

Factors like residual.sugar/free.sulfur.dioxide has significant outliers. However, considering the unit used, the outliers can be accepted and the data is tidy data.

# Bivariate Plots Section 


```{r echo=FALSE, message=FALSE,warning=FALSE, Bivariate_Plots}

ggpairs(df)

ggplot(aes(x=alcohol,y=density),data=df)+geom_point(alpha=1/5) + 
  ylim(0.985,1.005) + 
  geom_smooth(method='lm')

ggplot(aes(x=residual.sugar,y=density),data=df)+geom_point(alpha=1/5) + 
  xlim(0,40) + 
  ylim(0.98,1.02) + 
  geom_smooth(method='lm')

ggplot(aes(x=free.sulfur.dioxide,y=total.sulfur.dioxide),data=df) +
  geom_point(alpha=1/5) + 
  xlim(0,150) + 
  geom_smooth(method='lm')

ggplot(aes(x=fixed.acidity,y=pH),data=df) +
  geom_point(alpha=1/5) +
  geom_smooth(method='lm')

qplot(x = color, y = quality, data = df, geom = "boxplot")

qplot(x = color, y = fixed.acidity, data = df, geom = "boxplot")

qplot(x = color, y = alcohol, data = df, geom = "boxplot")

qplot(x = color, y = residual.sugar, data = df, geom = "boxplot")

qplot(x = color, y = sulphates, data = df, geom = "boxplot")

qplot(x = color, y = chlorides, data = df, geom = "boxplot")

```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

Density has negative relationship with alcohol. It also has positive correlation with residual sugar. The correlation coefficients are -0.687 and 0.553 respectively.

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

1. The white wine tend to have more alcohol, more residual sugar and less acids, less sulphates and chlorides.

2. As it has been assumed in section 1, there are some instinct relationship between the variables. For example, the free.sulfur.dioxide and total.sulfur.dioxide are positively related to each other. pH has negative relationship with acids.

### What was the strongest relationship you found?

The strongest relationship is between density and alhocol (R=-0.687), which makes sense because alhocol has smaller desity than water (desity = 49.3 lb/ft^3 and 62.4 lb/ft^3)

# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

ggplot(data=df,aes(x = quality, y = alcohol,color = color)) +
  geom_point(position=position_jitter(),size=1) +
  geom_smooth(method='lm')

ggplot(data=df,aes(x = quality, y = residual.sugar,color = color)) +
  geom_point(position=position_jitter(),size=1) +
  ylim(0,10)+
  geom_smooth(method='lm')

ggplot(data=df,aes(x = quality, y = fixed.acidity,color = color)) +
  geom_point(position=position_jitter(),size=1) +
  geom_smooth(method='lm')

ggplot(data=df,aes(x = quality, y = sulphates,color = color)) +
  geom_point(position=position_jitter(),size=1) +
  geom_smooth(method='lm')

ggplot(data=df,aes(x = quality, y = chlorides,color = color)) +
  geom_point(position=position_jitter(),size=1) +
  geom_smooth(method='lm')
             
```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

In this section, I found that the quality is related to alcohol, residual sugar, sulphates, chlorides, and acids.

### Were there any interesting or surprising interactions between features?

The standards used to judge the quality of red wine and white wine are different. 
For red wine, both residual sugar and acidityhave positive relationship with the quality. However, for white wine, both factors are negatively related to the quality. 
Sulphate has positive effect in red wine but white wine is not sensitive to sulphates.
Chlorides has negative effect on both red wine and white wine, but there are significantly amount of outliers.

------

# Final Plots and Summary
  
### Plot One Quality Distribution of Red & White Wine

```{r echo=FALSE,message=FALSE,warning=FALSE,Plot_One}
qplot(x= quality, fill = color, data = df,binwidth = 1) + 
  scale_x_continuous(breaks = seq(3,10,1), lim = c(3,10)) +
  ylab('Count') + xlab('Quality') 

```

The quality of wine has a slightly skewed normal distribution. Most wine were rated as 5 or 6. The lowest rating is 3 and the highest rating is 9.

### Plot Two Difference between Red & White Wine
```{r echo=FALSE, Plot_Two}
grid.arrange(qplot(x = color, y = quality, data = df, geom = "boxplot"),
             qplot(x = color, y = fixed.acidity, data = df, geom = "boxplot"),
             qplot(x = color, y = alcohol, data = df, geom = "boxplot"),
             qplot(x = color, y = residual.sugar, data = df, geom = "boxplot"),
             qplot(x = color, y = sulphates, data = df, geom = "boxplot"),
             qplot(x = color, y = chlorides, data = df, geom = "boxplot"),
             ncol=2)
```

This picture depicts the difference between red and white wine. Red wine has more acids, sulphate, chlorides, less sugar and slightly less alcohol.


### Plot Three
```{r echo=FALSE, Plot_Three}
grid.arrange(ggplot(data=subset(df,color='White'),aes(x = quality, y = alcohol)) +
              geom_point(alpha=1/4,position=position_jitter(),color='green') +
              geom_smooth(,method='loess',color='blue')+
              ggtitle('Alcohol vs.White Wine Quality'),
             ggplot(data=subset(df,color='Red'),aes(x = quality, y = alcohol)) +
              geom_point(alpha=1/4,position=position_jitter(),,color='red') +
              geom_smooth(,method='loess',color='yellow')+
              ggtitle('Alcohol vs. Red Wine Quality'),
             ncol=2)
```

The trend for relationship between alcohol content and quality are rather similar for both red and white wine. The wine rated as 5 has the lowest alcohol content. Overall, alcohol has positive relationship with the wine quality.

------
  
# Reflection

"The biggest difference between reds and whites is in how they're made. The grapes used for red and white wines generally look very differentâ€”as you might imagine, red wine grapes are darker and have more pigment. When making white wine, typically the grapes are pressed and then just the juice is fermented."1

The nature and brewing processes made the telling difference. Through the data, we looked into the differences between red and white wine from their chemical contents. Compared to the red wine, the white wine tend to have higher alcohol, more residual sugar and less acids, less sulphates and chlorides (probably because of the brewing process).

Some facotrs affecting quality also differed in red and white wine. Residual sugar and acids made positive contribution to the quality but they will decrease the taste for white wine. Sulphate positively influenced the red wine quality but white wine seems to be insensitive to this chemical. Both wine proned to rate higher alcohol content as better quality.

After all, quality rating is a relatively subjective factor. Human-beings, even the experts have their limits in distinguishing the tiny difference between each sample, not mentioned the consumers. That's probably why most wine were rated as 5 or 6. If more extreme cases (below 3 or greater than 8) can be gathered, I would be interested to see why those samples stand out as unique.


Reference:
1. http://www.winespectator.com/drvinny/show/id/44697
